<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formalizador de E-mails com Gemini</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-100 to-blue-200 flex items-center justify-center min-h-screen p-4">
    <div class="container mx-auto max-w-3xl w-full">
        <div class="glass-card rounded-2xl shadow-2xl p-6 md:p-10">
            <div class="text-center mb-8">
                <div class="flex items-center justify-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                    <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Formalizador de E-mails</h1>
                </div>
                <p class="text-gray-600 mt-3">Transforme qualquer rascunho em um e-mail profissional com um clique.</p>
            </div>

            <!-- Seletor de Estilo de Prompt -->
            <div class="mb-4">
                <label for="promptSelector" class="block text-sm font-medium text-gray-700 mb-2">Estilo do E-mail:</label>
                <select id="promptSelector" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition bg-white/50">
                    <option value="padrao" selected>Padrão (Formal e Objetivo)</option>
                    <option value="muito_formal">Muito Formal (Corporativo)</option>
                    <option value="amigavel">Amigável (Menos Formal)</option>
                    <option value="curto">Curto e Direto</option>
                    <option value="duas_opcoes">Gerar 2 Opções (Formal e Amigável)</option>
                </select>
            </div>

            <!-- Área de Input -->
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <label for="inputText" class="block text-sm font-medium text-gray-700">Seu texto:</label>
                    <button id="clearButton" class="text-xs text-gray-500 hover:text-red-600 transition-colors flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                        Limpar
                    </button>
                </div>
                <textarea id="inputText" rows="8" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition bg-white/50" placeholder="Ex: oi, preciso do relatório de vendas pra ontem. me manda aí."></textarea>
            </div>

            <!-- Botão de Ação -->
            <div class="text-center mb-6">
                <button id="formatButton" class="bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:shadow-lg hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-blue-300 flex items-center gap-2 mx-auto">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c.3 0 .6.1.8.4l4.9 4.9c.2.2.4.5.4.8v8.8c0 .8-.7 1.5-1.5 1.5H7.5c-.8 0-1.5-.7-1.5-1.5V9.1c0-.3.1-.6.4-.8l4.9-4.9c.2-.3.5-.4.8-.4Z"/><path d="M12 3v18"/></svg>
                    Formalizar Texto
                </button>
            </div>
            
            <!-- Animação de Carregamento -->
            <div id="loader" class="hidden flex justify-center my-4">
                <div class="loader"></div>
            </div>

            <!-- Área de Output -->
            <div id="outputContainer" class="hidden">
                 <div class="flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold text-gray-800">E-mail Formatado:</h2>
                    <button id="copyButton" class="bg-slate-200 text-slate-700 font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors duration-300 text-sm flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                        Copiar
                    </button>
                </div>
                <div id="outputText" class="w-full p-4 border bg-slate-50/80 border-gray-200 rounded-lg min-h-[150px] whitespace-pre-wrap"></div>
                 <p id="copyFeedback" class="text-sm text-green-600 mt-2 text-right hidden">Copiado para a área de transferência!</p>
            </div>
        </div>
        <footer class="text-center mt-8 text-gray-600 text-sm">
            <p>Criado por Solagna.CO</p>
        </footer>
    </div>

    <script>
        // --- Referências aos elementos do DOM ---
        const formatButton = document.getElementById('formatButton');
        const clearButton = document.getElementById('clearButton');
        const promptSelector = document.getElementById('promptSelector'); // Novo seletor
        const inputText = document.getElementById('inputText');
        const outputContainer = document.getElementById('outputContainer');
        const outputText = document.getElementById('outputText');
        const loader = document.getElementById('loader');
        const copyButton = document.getElementById('copyButton');
        const copyFeedback = document.getElementById('copyFeedback');

        // --- Event Listener para o botão de limpar ---
        clearButton.addEventListener('click', () => {
            inputText.value = '';
            outputText.innerText = '';
            outputContainer.classList.add('hidden');
            copyFeedback.classList.add('hidden');
        });

        // --- Função para gerar o prompt com base na seleção ---
        function getPrompt(type, text) {
            const baseText = `O texto a ser reescrito é:\n\n"${text}"`;
            switch (type) {
                case 'muito_formal':
                    return `Reescreva o seguinte texto como um e-mail de tom extremamente formal e corporativo, em português. Use uma linguagem polida, vocabulário rebuscado e uma estrutura clássica de correspondência comercial. ${baseText}`;
                case 'amigavel':
                    return `Reescreva o seguinte texto como um e-mail de tom amigável, porém profissional, em português. O objetivo é ser claro e cordial, mas sem ser excessivamente informal. ${baseText}`;
                case 'curto':
                    return `Reescreva o seguinte texto como um e-mail curto e direto, em português. Mantenha a formalidade necessária, mas foque em ser conciso e objetivo. ${baseText}`;
                case 'duas_opcoes':
                    return `Gere duas versões para um e-mail profissional a partir do texto a seguir. A primeira versão deve ser formal e objetiva. A segunda versão deve ter um tom mais amigável e cordial. Separe as duas versões claramente. ${baseText}`;
                case 'padrao':
                default:
                    return `Reescreva o seguinte texto como um e-mail formal e profissional, em português. O tom deve ser polido, claro e objetivo. Adicione uma saudação apropriada (como "Prezado(a)," ou "Bom dia,") e uma despedida cordial (como "Atenciosamente," ou "Cordialmente,"). ${baseText}`;
            }
        }

        // --- Event Listener para o botão de formatar ---
        formatButton.addEventListener('click', async () => {
            const apiKey = "AIzaSyB8DEuOcAad3AGQt-Yude4-B83l8ZFayzE"; 
            const userInput = inputText.value.trim();
            const promptType = promptSelector.value;

            if (!userInput) {
                outputText.innerText = "Por favor, insira um texto para formatar.";
                outputContainer.classList.remove('hidden');
                return;
            }

            loader.classList.remove('hidden');
            outputContainer.classList.add('hidden');
            copyFeedback.classList.add('hidden');
            formatButton.disabled = true;
            formatButton.classList.add('opacity-50', 'cursor-not-allowed');

            const prompt = getPrompt(promptType, userInput);

            let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("Erro da API:", errorBody);
                    throw new Error(`Erro na API: ${errorBody.error.message || response.statusText}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const formattedText = result.candidates[0].content.parts[0].text;
                    outputText.innerText = formattedText;
                } else {
                    console.log("Resposta da API recebida, mas sem conteúdo válido:", result);
                    outputText.innerText = "Não foi possível obter uma resposta formatada da IA. A resposta pode estar vazia ou em um formato inesperado.";
                }

            } catch (error) {
                console.error("Erro ao chamar a API do Gemini:", error);
                outputText.innerText = `Ocorreu um erro ao tentar formatar o texto. Por favor, tente novamente mais tarde. Detalhes: ${error.message}`;
            } finally {
                loader.classList.add('hidden');
                outputContainer.classList.remove('hidden');
                formatButton.disabled = false;
                formatButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        });

        // --- Event Listener para o botão de copiar ---
        copyButton.addEventListener('click', () => {
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = outputText.innerText;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            copyFeedback.classList.remove('hidden');
            setTimeout(() => {
                copyFeedback.classList.add('hidden');
            }, 2000);
        });
    </script>
</body>
</html>
